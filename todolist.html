<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"">
    <link href="style4.css?v8" rel="stylesheet" type="text/css">
    <title>Todo list</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
    <script>
        $(function(){

            var togglebtn = $('.togglebtn');
            var date = $('.today');
            var social = $('.socialmedia');
            var addbtn = $('input+button');
            var sectitle = $('.sectitle');
            var input = $('#seccontent2 div input');
                    
            togglebtn.click(function(){
                date.toggleClass('active');
                social.toggleClass('active');
            });
        
            today();
            function today() {
                var today = new Date();
                var dd = today.getDate();
                var mm = today.getMonth()+1;
                var yyyy = today.getFullYear();
                var week =new Array('Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat');
                var day = week[today.getDay()]
        
                if(dd<10){dd = '0'+dd}
                if(mm<10){mm = '0'+mm}
        
                todayout = yyyy + '-' + mm + '-' + dd +' '+day;
                $('#todaydate').text(todayout);
            }

            var time = new Date();
            var hour = time.getHours();
            var min = time.getMinutes();
            var ampm = $('#clock div').eq(0);
            var hour1 = $('#clock div').eq(1);
            var hour2 = $('#clock div').eq(2);
            var colon = $('#clock div').eq(3);
            var min1 = $('#clock div').eq(4);
            var min2 = $('#clock div').eq(5);

            timenow();
            setInterval(timechange, 5000);

            function timenow(){
                if (hour < 12){
                    ampm.text("am ");
                }else{
                    ampm.text("pm ");
                    if(hour > 12) hour=hour-12;
                }

                if (hour<10){
                    hour1.text('0');
                    hour2.text(hour);
                }else{
                    hour1.text('1');
                    hour2.text(hour%10);
                }

                colon.text(':');

                if (min<10){
                    min1.text('0');
                    min2.text(min);
                }else{
                    min1.text(parseInt(min/10));
                    min2.text(min%10);
                }

                rotation();
                setTimeout(() => {deleteRotation();}, 4000);
            }

            function rotation(){
                setTimeout(() => {ampm.addClass('show').addClass('rotate');}, 500);
                setTimeout(() => {hour1.addClass('show').addClass('rotate');}, 1000);
                setTimeout(() => {hour2.addClass('show').addClass('rotate');}, 1200);
                setTimeout(() => {min1.addClass('show').addClass('rotate');}, 1500);
                setTimeout(() => {min2.addClass('show').addClass('rotate');}, 1700);
                setTimeout(() => {colon.css('color','var(--text-color)');}, 2000);
            }

            function deleteRotation(){
                ampm.removeClass('rotate');
                hour1.removeClass('rotate');
                hour2.removeClass('rotate');
                min1.removeClass('rotate');
                min2.removeClass('rotate');
                colon.removeClass('rotate');
            }

            function timechange(){
                var newtime = new Date();
                var newtimehour = newtime.getHours();
                var newtimemin = newtime.getMinutes();
                var newtimesec = newtime.getSeconds();

                if (newtimehour < 12){
                    if (ampm.text() != "am ") {
                        ampm.addClass('rotate');
                        setTimeout(() => {ampm.text("am ");}, 500);
                    }
                }else{
                    if (ampm.text() != "pm ") {
                        ampm.addClass('rotate');
                        setTimeout(() => {ampm.text("pm ");}, 500);
                    }
                }
                
                if(newtimehour > 12) newtimehour=newtimehour-12;

                if (newtimehour < 10){
                    if (hour1.text() != '0') {
                        hour1.addClass('rotate');
                        setTimeout(() => {hour1.text('0');}, 500);
                    }
                    if (parseInt(hour2.text()) != newtimehour) {
                        hour2.addClass('rotate');
                        setTimeout(() => {hour2.text(newtimehour);}, 500);
                    }
                }else{
                    if (hour1.text() != '1') {
                        hour1.addClass('rotate');
                        setTimeout(() => {hour1.text('1');}, 500);
                    }
                    if (parseInt(hour2.text()) != newtimehour%10) {
                        hour2.addClass('rotate');
                        setTimeout(() => {hour2.text(newtimehour%10);}, 500);
                    }
                }

                if (newtimemin<10){
                    if (min1.text() != '0') {
                        min1.addClass('rotate');
                        setTimeout(() => {min1.text('0');}, 500);
                    }
                    if (parseInt(min2.text()) != newtimemin) {
                        min2.addClass('rotate');
                        setTimeout(() => {min2.text(newtimemin);}, 500);
                    }
                    
                }else{
                    if (parseInt(min1.text()) != parseInt(newtimemin/10)) {
                        min1.addClass('rotate');
                        setTimeout(() => {min1.text(parseInt(newtimemin/10));}, 500);
                    }
                    if (parseInt(min2.text()) != newtimemin%10) {
                        min2.addClass('rotate');
                        setTimeout(() => {min2.text(newtimemin%10);}, 500);
                    }
                }
                setTimeout(() => {deleteRotation();}, 2000);
            }
            
            $.getJSON('http://api.openweathermap.org/data/2.5/forecast?id=6094817&appid=8c8fa9eae4c801b616620cf6186cd33f&units=metric', function(data){
                    var roundtemp = Math.round(data.list[0].main.temp);
                    $('.temp').html(roundtemp+' °C ');
                    $('.description').html('Description : '+ data.list[0].weather[0].description);
                    $('.curtemp').html('Current Temperature : '+ data.list[0].main.temp+' °C ');
                    $('.feellike').html('Feel like : '+ data.list[0].main.feels_like +' °C ');
                    $('.windspeed').html('Wind Speed : '+ data.list[0].wind.speed +' m/s ');
                    
                    var weathericone = data.list[0].weather[0].icon;
                    $('.icon').html('<img src="http://openweathermap.org/img/w/'+ weathericone +'.png">');
                });

            sectitle.click(function(){
                $(this).next().toggleClass('open');
                if($(this).next().hasClass('open')){
                    $(this).css({'border-bottom':'0.4vh solid var(--accent-color)'});
                    $(this).find('i').eq(1).css({'transform':'rotate(180deg)','visibility':'visible','transition':'transform 0.5s'});
                    $(this).next().stop().animate({'max-height': '68vh', 'margin-top':'3vh'}, 700, 'easeOutBounce');
                    input.focus();
                    if ( $('#seccontent2').hasClass('open') ) $('#seccontent2+span').css({'visibility':'visible'});
                }else{
                    $(this).css({'border-bottom':'0.4vh solid transparent'});
                    $(this).find('i').eq(1).css({'transform':'rotate(0deg)','visibility':'hidden','transition':'transform 0.5s'});
                    $(this).next().stop().animate({'max-height': 0, 'margin-top':'0vh'});
                    if ( !$('#seccontent2').hasClass('open') ) $('#seccontent2+span').css({'visibility':'collapse'});
                }
            });

            if ( $('#seccontent2').hasClass('open') ) {
                $('#seccontent2+span').css({'visibility':'visible'});
            } else {
                $('#seccontent2+span').css({'visibility':'hidden'});
            }

            var todoarr = []
            var storage_output = localStorage.getItem("todolist");		
            var arroutput = JSON.parse(storage_output);

            var line = localStorage.getItem("checkedlist");	
            var linethrough = JSON.parse(line);
        
            if(arroutput != null){
                for(var i=0; i<arroutput.length; i++){
                    oneline = $('<li><input type="checkbox" class="checkbox">'+ arroutput[i] + '<i class="fas fa-trash-alt"></i></li>');
                    oneline.appendTo('#seccontent2 ul');
                    if(linethrough != null){
                        if (linethrough[i] == 'yes') {
                            $('#seccontent2 ul li').eq(i).addClass('checked').css({'text-decoration':'line-through'});
                            $('.checkbox').eq(i).prop('checked', true);
                        }
                    }
                    todoarr.push(arroutput[i]);
                }
            }

            $('#sectitle2 div').append('<span> : '+todoarr.length+'<span>');

            function addlist(){
                var newline = $('<li><input type="checkbox" class="checkbox"></li>');
                var value = input.val();
                
                if(value != ''){    
                    newline.append(value+'<i class="fas fa-trash-alt"></i>');
                    newline.appendTo('#seccontent2 ul');
                    if ($('#sticky').prop('checked')) {
                        $('#seccontent2 ul li').addClass('stickynote');
                    }
                    todoarr.push(value);
                    $('#sectitle2 div span').remove();
                    $('#sectitle2 div').append('<span> : '+todoarr.length+'<span>');
                    localStorage.setItem("todolist", JSON.stringify(todoarr));
                    input.val('').focus();
                }
            }

            $(document).ready(function() {
                addbtn.click(addlist);
                input.keypress(function(e) {
                    if (e.which == 13) {
                        addlist();
                        $('#seccontent2').scrollTop($('#seccontent2')[0].scrollHeight);
                    }
                });
            });
            
            $(document).on('click', '.checkbox', function(){
                $(this).closest('li').toggleClass('checked');
                if ($(this).closest('li').hasClass('checked')){
                    $(this).closest('li').css({'text-decoration':'line-through'});
                }else{
                    $(this).closest('li').css({'text-decoration':'none'});
                }
                var checkedarr = [];
                for(var i = 0; i < todoarr.length; i++) {
                    if ($('#seccontent2 ul li').eq(i).hasClass('checked')){
                        checkedarr.push('yes');
                    }else{
                        checkedarr.push('no');
                    }
                }
                localStorage.setItem("checkedlist", JSON.stringify(checkedarr));
            });

            $(document).on('mouseover', '#seccontent2 ul li', function(){
                $(this).css({'color':'dimgray'});
                $(this).find('i').css({'visibility':'visible'});
            });

            $(document).on('mouseout', '#seccontent2 ul li', function(){
                $(this).css({'color':'var(--text-color)'});
                $(this).find('i').css({'visibility':'hidden'});
            });

            $(document).on('click', '#seccontent2 ul li i', function(){
                $(this).closest('li').remove();
                for(var i = 0; i < todoarr.length; i++) {
                    if(todoarr[i] == $(this).closest('li').text())  {
                        todoarr.splice(i, 1);
                        i--;
                    }
                }
                $('#sectitle2 div span').remove();
                $('#sectitle2 div').append('<span> : '+todoarr.length+'<span>');
                localStorage.setItem("todolist", JSON.stringify(todoarr));

                var checkedarr = [];
                for(var i = 0; i < todoarr.length; i++) {
                    if ($('#seccontent2 ul li').eq(i).hasClass('checked')){
                        checkedarr.push('yes');
                    }else{
                        checkedarr.push('no');
                    }
                }
                localStorage.setItem("checkedlist", JSON.stringify(checkedarr));
            });

            $('.clockframe').click(function(){
                $(this).addClass('spin');
                $('main>i').addClass('spin');
            });

            $('main>i').click(function(){
                $(this).removeClass('spin');
                $('.clockframe').removeClass('spin');
            });

            $('.setting i').click(function(){
                $(this).toggleClass('turnon');
                if ($(this).hasClass('turnon')){
                    $(this).css({'transform':'rotate(45deg)','transition':'all 0.5s'});
                    $('.setting div').css({'visibility':'visible'});
                }else{
                    $(this).css({'transform':'rotate(0deg)','transition':'all 0.5s'});
                    $('.setting div').css({'visibility':'collapse'});
                }
            });

            $('input:radio[name=background]').change(function(){

                if ($('#pic1').prop('checked')) {
                    $('body').css({'background-image':"url('background_puppy.jpg')",'transition':'all 1s'});
                    $('nav, .sectitle, form button, main>i').css({'--text-color':'rgb(240, 240, 240)'});
                    $(':root').css({'--accent-color':'orange', '--accent-color2':'darkorange', '--accent-color3':'rgb(255, 217, 0)'});
                    $('nav>div>i').removeClass('fas fa-cat').addClass('fas fa-dog');
                }else if ($('#pic2').prop('checked')) {
                    $('body').css({'background-image':"url('background_cat.jpg')",'transition':'all 1s'});
                    $('nav, .sectitle, form button, main>i').css({'--text-color':'rgb(38, 55, 74)'});
                    $(':root').css({'--accent-color':'mediumslateblue', '--accent-color2':'navy', '--accent-color3':'pink'});
                    $('.seccontent').css({'color':'var(--text-color)'});
                    $('nav>div>i').removeClass('fas fa-dog').addClass('fas fa-cat');
                }
            })

            $('input:checkbox[id=sticky]').change(function(){
                if ($('#sticky').prop('checked')) {
                    $('#seccontent2 ul li').addClass('stickynote');
                    $('.seccontent').css({'background-color':'transparent', 'box-shadow':'0.2vh 0.2vw 0.5vw black'});
                }else{
                    $('#seccontent2 ul li').removeClass('stickynote');
                    $('.seccontent').css({'background-color':'var(--background-dark)', 'box-shadow':'unset'});
                }
            });

            var hourlyalarm;
            $('.clockframe i').click(function(e){
                e.stopPropagation();
                if (Notification.permission !== 'granted'){
                    if (window.Notification) {
                        Notification.requestPermission();
                    }
                    if (Notification.permission !== 'granted') {
                        alert('\nIf notifications are blocked, Eye Rest Notification is unavailable. \nPlease allow notifications and click again the icon.');
                    }
                }else{    
                    $(this).toggleClass('on');
                    if($(this).hasClass('on')){
                        $(this).removeClass('far fa-eye-slash').addClass('far fa-eye');
                        alert('Eye Rest Notification : ON\nThe notification will appear every hour from now on.');
                        hourlyalarm = setInterval(function(){            
                            var notification = new Notification("It has been one hour.\nPlease rest your eyes for a while!");
                        }, 3600000); 
                    }else{
                        $(this).removeClass('far fa-eye').addClass('far fa-eye-slash');
                        alert('Eye Rest Notification : OFF\nPlease rest your eyes regularly!');
                        clearInterval(hourlyalarm);
                    }
                }    
            });

            $( "#sortable" ).sortable({
                cursor:'move',
                opacity:0.8
            });
            
        }); // end
    </script>
</head>
<body>

    <nav>
        <div class="logo">
            <i class="fas fa-dog"></i>
            <a href="todolist.html">To-do List</a>
        </div>
        
        <ul class="today">
            <li><a href="https://news.google.com/topstories?hl=en-CA&gl=CA&ceid=CA:en" target="_blank"><i class="fab fa-google"></i> News</a></li>
            <li><a href="https://www.astrology.com/horoscope/daily.html" target="_blank"><i class="far fa-star"></i> Today's luck</a></li>
            <li><a href="index.php"><i class="fab fa-product-hunt"></i> Portfolio List</a></li>
        </ul>
        <ul class="socialmedia">
            <li><a href="https://www.facebook.com/" target="_blank"><i class="fab fa-facebook-square"></i></a></li>
            <li><a href="https://www.instagram.com/" target="_blank"><i class="fab fa-instagram"></i></a></li>
        </ul>

        <a href="#" class="togglebtn"><i class="fas fa-bars"></i></a>

    </nav>

    <main>
        <form method="get" action="https://www.google.com/search" target="_blank" >   
            <input type="text" name="q" value=""/>      
            <button type="submit"><i class="fas fa-search"></i></button> 
        </form>
        
        <div>
            <section class="sectitle" id="sectitle1">
                    <div><i class="fas fa-temperature-high"></i> Ottawa</div>
                    <div>
                        <div class="icon"></div>
                        <div class="temp"></div>
                    </div>
                    <i class="fas fa-arrow-circle-down"></i>
            </section>

            <section class="seccontent" id="seccontent1">
                <ul>
                    <li class="description"></li>
                    <li class="curtemp"></li>
                    <li class="feellike"></li>
                    <li class="windspeed"></li>
                    <li>: Information from OpenWeather API</li>
                </ul>    
            </section>
        </div>
        <div>
            <section class="sectitle" id="sectitle2">
                    <div><i class="far fa-list-alt"></i> &nbsp;To-do List</div>
                    <i class="fas fa-arrow-circle-down"></i>
            </section>
            <section class="seccontent" id="seccontent2">
                <ul id="sortable">
                </ul> 
                <div>
                    <input type="text"> 
                    <button>Add</button>
                </div>  
            </section>
            <span>* Sort lists by clicking and dragging.</span>            
        </div>

        <i class="far fa-clock"><span> Clock</span></i>
        <div class = 'clockframe'>
            <div id="todaydate"></div>
            <section id="clock">
                    <div></div>
                    <div></div>
                    <div></div>
                    <div>:</div>
                    <div></div>
                    <div></div>
            </section>
            <span>Flip Clock</span>
            <i class="far fa-eye-slash"></i>
        </div>
        
        <div class='setting'>
            <i class="fas fa-cog"></i>
            <div>
                <div>
                    Background Image<br>
                    <input type='radio' id='pic1' name='background'checked> Dog
                    <input type='radio' id='pic2' name='background'> Cat
                </div>
                <div>
                    <input type='checkbox' id='sticky'> Sticky note mode
                </div>
        </div>
            
        </div>
    </main>    
</body>
</html>

